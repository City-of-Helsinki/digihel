{% extends "base.html" %}
{% load wagtailcore_tags digi_tags static %}

{% block content %}
<div class="container main-container" role="main">
  <div class="row">
    <div class="col-xs-12">
      {% if category %}
      <h2 class="blog-section-header">{{ category }}</h2>
      {% endif %}
      {% if tag %}
      <h2 class="blog-section-header">Blogikirjoitukset tagill√§ '{{ tag }}'</h2>
      {% else %}
      <div class="row">
        <div class="col-xs-12">
          <h2 class="blog-section-header"><a href="/blogikirjoitukset">Digipajan Blogi</a></h2>
        </div>
        {% for blog in blogs|slice:":1" %}
        <div class="col-xs-12">
          <div class="blog-index-highlight" style="background-image: url('http://loremflickr.com/1280/800/helsinki')">
            <a class="link-unstyled" href="{% pageurl blog %}">
              <div class="blog-highlight-content">
              <div class="blog-hilight-header"><h2>{{ blog.title }}</h2>
                <small>27.6.2016</small>
              </div>
              <div class="blog-highlight-blurb">{{ blog.body|first_p|safe }}</div>
            </div></a>
          </div>
        </div>
        {% endfor %}
      </div>
      {% endif %}
    </div>
  </div>
    {% for rl in self.related_links.all %}
        <p>{{ rl.title }}: <a href='{{ rl.link_page.url }}'>{{ rl.link_page }}</a></p>
    {% endfor %}
    {% if blogs %}
        <ul class="blog-index list-unstyled the-loop row">
        {% for blog in blogs %}
            <li class="blog-post-item{% if forloop.first and not category and not tag %} first-reset{% endif %}">
                {% include 'blog/blog_post.html' with include_context="index_page" %}
            </li>
        {% endfor %}
        </ul>

        <ul class="pager">
        {% if blogs.has_next %}
          <li class="previous"><a href="?page={{ blogs.next_page_number }}{% for key,value in request.GET.items %}{% ifnotequal key 'page' %}&amp;{{ key }}={{ value }}{% endifnotequal %}{% endfor %}">&larr; Older</a></li>
        {% endif %}
        {% if blogs.has_previous %}
          <li class="next"><a href="?page={{ blogs.previous_page_number }}{% for key,value in request.GET.items %}{% ifnotequal key 'page' %}&amp;{{ key }}={{ value }}{% endifnotequal %}{% endfor %}">Newer &rarr;</a></li>
        {% endif %}
        </ul>

    {% else %}
        <p>There are currently no blog posts</p>
    {% endif %}    
  </div>
{% endblock %}
