function definitionListPlugin(a,b){function c(b){var c;if(13==b.keyCode&&(c=a.dom.getParent(a.selection.getNode(),"dt, dd"),c&&a.dom.isEmpty(c))){b.preventDefault();var d=a.dom.getParent(a.selection.getNode(),"dl"),e=a.dom.rename(c,"p");a.dom.split(d,e)}return 9==b.keyCode&&(c=a.dom.getParent(a.selection.getNode(),"dt, dd"))?(b.preventDefault(),a.execCommand("ToggleDefinitionItem"),!1):void 0}function d(){var b,c=a.selection,d=a.dom,e=d.getParent(c.getNode(),"dt");return e?(b=c.getBookmark(),d.rename(e,"dd"),void c.moveToBookmark(b)):(e=d.getParent(c.getNode(),"dd"),void(e&&(b=c.getBookmark(),d.rename(e,"dt"),c.moveToBookmark(b))))}function e(){var b,c=a.selection,d=c.getRng(),e=a.dom,j=e.getParent(c.getNode(),"dl,ul,ol");if(j)"DL"==j.nodeName.toUpperCase()?(b=c.getBookmark(),h(j,d),c.moveToBookmark(b)):i(j,d);else{var k=e.getParent(c.getNode(),"p");if(k){b=c.getBookmark();var l=e.rename(k,"dt");j=f(l,"dl"),c.moveToBookmark(b)}else if(!c.isCollapsed()){var m=g(d,!0);j=e.getParent(m[0],"dl"),j||(j=e.create("dl"),e.insertAfter(j,m[0])),tinymce.each(m,function(a){var b;b=e.is(a,"p, li, dt")?e.rename(a,"dt"):f(a,"dt");try{e.add(j,b)}catch(d){}c.setCursorLocation(b)})}}e.remove(e.select("dl:empty"))}function f(b,c){var d=a.dom,e=d.create(c);return d.insertAfter(e,b),d.add(e,b),e}function g(b,c){var d=b.commonAncestorContainer,e=[];return tinymce.each(d.childNodes,function(d){var f=a.dom;b.intersectsNode(d)&&(c&&f.is(d,"ul, ol, dl")?tinymce.each(d.childNodes,function(a){e.push(a)}):c&&f.is(d,"p")&&1==d.childNodes.length&&f.is(d.childNodes[0],"ul, ol, dl")?tinymce.each(d.childNodes[0].childNodes,function(a){e.push(a)}):e.push(d))}),e}function h(b,c){var d=a.dom,e=[],f=d.getParent(c.commonAncestorContainer,"dt,dd");f?e.push(f):e=g(c);var h=d.rename(e.shift(),"p");d.split(b,h),tinymce.each(e,function(a){var b=h;h=d.rename(a,"p"),d.insertAfter(h,b)})}function i(b,c){var d=a.dom,e=[],h=d.getParent(c.commonAncestorContainer,"li");h?e.push(h):e=g(c);var i=d.rename(e.shift(),"dt");d.split(b,i);var j=f(i,"dl");tinymce.each(e,function(a){var b=d.rename(a,"dt");d.add(j,b)})}a.contentCSS.push(b+"/plugin-style.css"),a.addCommand("ToggleDefinitionItem",d),a.addCommand("ToggleDefinitionList",e),a.on("keydown",c),a.addButton("ToggleDefinitionItem",{text:"DT\u2194DD",tooltip:"Switch Between Term and Definition",icon:!1,cmd:"ToggleDefinitionItem",onPostRender:function(){var b=this;a.on("NodeChange",function(c){b.disabled(!a.dom.getParent(c.element,"dl>dt,dl>dd"))})}}),a.addButton("ToggleDefinitionList",{text:"DL",tooltip:"Definition List",icon:!1,cmd:"ToggleDefinitionList",stateSelector:"dl"})}tinymce.PluginManager.add("definitionlist",definitionListPlugin);